<div class="container" *ngIf="response && response.data?.length>0; else emptyPage">
    <div class="mat-elevation-z8">
        <table mat-table [dataSource]="response.data" matSort class="mat-elevation-z8">
            
            <!-- Count Down -->
            <ng-container matColumnDef="countdown">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Giờ đếm ngược </th>
                <td
                    mat-cell
                    *matCellDef="let element"
                    class="countdownCell"
                >
                    <div
                        *ngIf="element.countDown | async as countDown"
                        [class.background-pending-status]="countDown.minutes<=10"
                        [class.background-pending-status-overtime]="countDown.minutes == -1 && countDown.seconds == -1"
                    >
                        <p>
                            <mat-icon>schedule</mat-icon>
                            <span class="primary-key">
                                {{ ('0'+countDown.minutes).slice(-2) +':'+ ('0'+countDown.seconds).slice(-2) }}
                            </span>
                        </p>
                    </div>
                    
                </td>
            </ng-container>

            <!-- Id Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Trường hợp số </th>
                <td mat-cell *matCellDef="let element"> {{element.ID}} </td>
            </ng-container>
            
            <!-- Loại hình điều trị -->
            <ng-container matColumnDef="ill_cause">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Loại hình điều trị </th>
                <td mat-cell *matCellDef="let element">{{traTuService.illCauses[element.ill_cause-1].name}}</td>
            </ng-container>
            
            <!-- Họ và Tên -->
            <ng-container matColumnDef="fullname">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Họ và Tên </th>
                <td mat-cell *matCellDef="let element"> {{element.fullname}} </td>
            </ng-container>
            
            <!-- Ngày sinh -->
            <ng-container matColumnDef="dob">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Ngày sinh </th>
                <td mat-cell *matCellDef="let element"> {{element.dob}} </td>
            </ng-container>

            <!-- Kiểu yêu cầu -->
            <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Kiểu yêu cầu</th>
                <td mat-cell *matCellDef="let element">
                    <span>{{ element.costs.length>0 ? 'Yêu cầu Bảo Lãnh' : 'Kiểm tra Quyền Lợi' }}</span>
                </td>
            </ng-container>

            <!-- Nút Chọn Xử Lý -->
            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                <td mat-cell *matCellDef="let element" class="actionCell">
                    <button (click)="startProccess(element)">Bắt đầu xử lý</button>
                </td>
            </ng-container>
            
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <mat-paginator
            [length]="length"
            [pageSize]="pageSize"
            [pageSizeOptions]="pageSizeOptions"
            (page)="pageChangeEvent($event)"
            showFirstLastButtons
        ></mat-paginator>
    </div>
    <div class="padding-for-the-list"></div>
</div>

<ng-template #emptyPage>
    <app-empty-page [warning]="'Không thấy Bệnh Viện gửi yêu cầu thông tin gì nhỉ!'"></app-empty-page>
</ng-template>